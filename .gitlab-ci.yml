stages:
  - 🐍 lint

variables:
  DOCKER_IMAGE_NAME: ${CI_REGISTRY_IMAGE}/pyqgis-qt-checker:latest
  DOCKER_IMAGE_GITTAG: ${DOCKER_IMAGE_NAME}:${DOCKER_IMAGE_TAG}
  DOCKER_IMAGE_LATEST: ${DOCKER_IMAGE_NAME}:latest

# -- LINT JOBS ---
docker-hadolint:
  stage: 🧹 lint
  image: hadolint/hadolint:latest-debian
  tags:
    - oslandia_docker
  script:
    - mkdir -p reports
    - hadolint -f gitlab_codeclimate Dockerfile > reports/hadolint-$(md5sum Dockerfile | cut -d" " -f1).json
  artifacts:
    name: "$CI_JOB_NAME artifacts from $CI_PROJECT_NAME on $CI_COMMIT_REF_SLUG"
    expire_in: 7 days
    when: always
    reports:
      codequality:
        - "reports/*"
    paths:
      - "reports/*"
